<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Hans — The Living Library</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root {
  --bg:#0b0814;
  --panel:#140b25;
  --violet:#a88bff;
  --lav:#e6dcff;
  --iron:#3c2f52;
  --glow:0 0 12px rgba(168,139,255,.6);
}

* { box-sizing:border-box; }

body {
  margin:0;
  background:
    radial-gradient(circle at top, #1b1135, #07050c);
  font-family: "Garamond", serif;
  color:var(--lav);
  overflow:hidden;
}

/* ================= HANS BALCONY ================= */
#balcony {
  height:150px;
  background:linear-gradient(#160b2a,#090611);
  border-bottom:3px solid var(--iron);
  display:flex;
  align-items:center;
  padding:16px;
  gap:20px;
}

#hans-chat {
  flex:1;
  font-style:italic;
  font-size:18px;
}

/* ================= STAGE ================= */
#stage {
  height:calc(100vh - 150px);
  display:grid;
  grid-template-rows:120px 1fr;
  background:
    linear-gradient(#0b0814,#05030a);
}

/* ================= SHELF ROW ================= */
#shelves {
  display:flex;
  justify-content:center;
  gap:16px;
  padding:20px;
}

.shelf-slot {
  width:90px;
  height:120px;
  border:2px dashed rgba(168,139,255,.4);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:12px;
  text-align:center;
  cursor:pointer;
}

.shelf-slot.filled {
  border-style:solid;
  box-shadow:var(--glow);
}

.shelf-slot:hover {
  box-shadow:var(--glow);
}

/* ================= PLAY AREA ================= */
#play-area {
  display:grid;
  grid-template-columns:1fr 260px;
}

/* ================= CARRIER ================= */
#carrier-area {
  display:flex;
  align-items:center;
  justify-content:center;
  gap:20px;
}

#carrier {
  width:180px;
  height:120px;
  border:2px solid var(--iron);
  display:flex;
  justify-content:center;
  align-items:center;
  box-shadow:var(--glow);
}

.book {
  width:28px;
  height:90px;
  background:linear-gradient(#5e4a88,#2d204a);
  margin:0 4px;
  cursor:pointer;
}

.controls button {
  background:transparent;
  border:1px solid var(--violet);
  color:var(--lav);
  padding:6px 10px;
  cursor:pointer;
}

/* ================= HANS VIDEO ================= */
#hans-panel {
  background:linear-gradient(#120a22,#07050c);
  border-left:3px solid var(--iron);
  display:flex;
  flex-direction:column;
}

#hans-video {
  width:100%;
  height:100%;
  object-fit:cover;
}
</style>
</head>

<body>

<!-- BALCONY -->
<div id="balcony">
  <div id="hans-chat">…</div>
</div>

<!-- STAGE -->
<div id="stage">

  <!-- SHELVES -->
  <div id="shelves">
    <div class="shelf-slot filled" data-accept="tragedy">Macbeth</div>
    <div class="shelf-slot" data-accept="tragedy"></div>
    <div class="shelf-slot filled" data-accept="comedy">Twelfth Night</div>
    <div class="shelf-slot" data-accept="comedy"></div>
  </div>

  <!-- PLAY AREA -->
  <div id="play-area">

    <!-- CARRIER -->
    <div id="carrier-area">
      <div class="controls">
        <button onclick="moveCarrier(-1)">◀</button>
      </div>

      <div id="carrier">
        <div class="book" data-type="tragedy" title="Othello"></div>
      </div>

      <div class="controls">
        <button onclick="moveCarrier(1)">▶</button>
      </div>
    </div>

    <!-- HANS -->
    <div id="hans-panel">
      <video id="hans-video" autoplay muted loop>
        <source src="hans.mp4" type="video/mp4">
      </video>
    </div>

  </div>
</div>

<script>
/* ================= MEMORY ================= */
const memory = JSON.parse(localStorage.getItem("hansMemory")||"{}");
memory.visits = (memory.visits||0)+1;
localStorage.setItem("hansMemory",JSON.stringify(memory));

const chat = document.getElementById("hans-chat");

/* ================= DIALOGUE ================= */
const correctLines = [
  "Hmm. Acceptable. Disturbingly so.",
  "Yes… the shelf breathes easier now.",
  "You surprise me. I dislike that."
];

const wrongLines = [
  "Absolutely not.",
  "That shelf would revolt.",
  "Please remove it before the books gossip."
];

chat.textContent =
  memory.visits===1
  ? "Welcome. Touch nothing unless you’re prepared to be judged."
  : "Back again? The shelves remember you.";

/* ================= BOOK PLACEMENT ================= */
let heldBook = document.querySelector(".book");

document.querySelectorAll(".shelf-slot").forEach(slot=>{
  slot.onclick = ()=>{
    if(!heldBook) return;
    if(slot.dataset.accept === heldBook.dataset.type){
      slot.classList.add("filled");
      slot.textContent = heldBook.title;
      heldBook.remove();
      heldBook=null;
      chat.textContent = correctLines[Math.floor(Math.random()*correctLines.length)];
    } else {
      chat.textContent = wrongLines[Math.floor(Math.random()*wrongLines.length)];
    }
  };
});

/* ================= CARRIER MOVE ================= */
let carrierOffset = 0;
function moveCarrier(dir){
  carrierOffset += dir*80;
  document.getElementById("carrier").style.transform =
    `translateX(${carrierOffset}px)`;
}

/* ================= VIDEO AUDIO ================= */
const video = document.getElementById("hans-video");
document.addEventListener("click",()=>{
  video.muted=false;
  video.play();
},{once:true});
</script>

</body>
</html>

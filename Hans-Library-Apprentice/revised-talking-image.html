<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Hans ‚Äî The Edwardian Library</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root {
  --bg: #0b0814;
  --violet: #a88bff;
  --lavender: #e6d9ff;
  --iron: #3b2f4a;
}

body {
  margin: 0;
  background: radial-gradient(circle at top, #1a1030, var(--bg));
  color: var(--lavender);
  font-family: "Garamond", serif;
  overflow: hidden;
}

/* ================= CURTAINS ================= */
#curtains {
  position: fixed;
  inset: 0;
  display: flex;
  z-index: 20;
}
.curtain {
  width: 50%;
  background: linear-gradient(#2b103a, #14081f);
  transition: transform 2s ease;
}
#curtain-left { transform-origin: left; }
#curtain-right { transform-origin: right; }

/* ================= BALCONY ================= */
#balcony {
  position: absolute;
  top: 0;
  width: 100%;
  height: 140px;
  background: linear-gradient(#14081f, #0b0814);
  border-bottom: 4px solid var(--iron);
  display: flex;
  align-items: center;
  padding: 10px 20px;
  z-index: 5;
}

#hans-avatar {
  width: 90px;
  height: 90px;
  border-radius: 50%;
  border: 2px solid var(--violet);
  background: url("https://dummyimage.com/180x180/3b2f4a/e6d9ff&text=Hans") center/cover;
  margin-right: 20px;
}

#hans-dialogue {
  font-style: italic;
  max-width: 70%;
}

/* ================= ORNATE DIVIDER ================= */
#divider {
  position: absolute;
  top: 140px;
  width: 100%;
  height: 18px;
  background:
    repeating-linear-gradient(
      90deg,
      var(--iron) 0px,
      var(--iron) 6px,
      transparent 6px,
      transparent 12px
    );
  z-index: 4;
}

/* ================= LIBRARY ================= */
#library {
  position: absolute;
  top: 160px;
  bottom: 0;
  width: 100%;
  display: grid;
  grid-template-columns: 1fr 1fr 220px;
  gap: 20px;
  padding: 20px;
  z-index: 1;
}

.shelf-column {
  display: flex;
  flex-direction: column;
  gap: 16px;
  overflow-y: auto;
  padding-right: 6px;
}

.shelf {
  border: 2px solid var(--iron);
  padding: 8px;
  background: rgba(30, 18, 50, 0.6);
  position: relative;
}

.shelf::before,
.shelf::after {
  content: "‚ù¶";
  position: absolute;
  color: var(--violet);
  font-size: 18px;
}
.shelf::before { top: -10px; left: -10px; }
.shelf::after { bottom: -10px; right: -10px; }

.shelf-title {
  font-size: 14px;
  margin-bottom: 6px;
  text-transform: uppercase;
}

/* ================= BOOKS ================= */
.book-slot {
  display: inline-block;
  width: 28px;
  height: 80px;
  margin: 2px;
  border: 1px dashed rgba(200,170,255,0.4);
  position: relative;
}

.book {
  position: absolute;
  width: 28px;
  height: 80px;
  background: linear-gradient(#5b3f7a, #2c183f);
  border: 1px solid var(--violet);
  cursor: grab;
  z-index: 10; /* FIXED: always above shelves */
}

.book:hover::after {
  content: attr(data-title);
  position: absolute;
  top: -22px;
  left: -10px;
  background: #14081f;
  padding: 2px 6px;
  font-size: 12px;
  white-space: nowrap;
  border: 1px solid var(--violet);
}

/* ================= CARRIER ================= */
#carrier {
  position: absolute;
  bottom: 30px;
  left: 40%;
  width: 200px;
  height: 90px;
  background: rgba(40,20,60,0.8);
  border: 2px solid var(--violet);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 3;
  transition: transform 0.6s ease;
}

/* ================= HANS VIDEO ================= */
#magnified-hans {
  position: absolute;
  right: 0;
  top: 160px;
  width: 220px;
  height: calc(100% - 160px);
  object-fit: cover;
  opacity: 0.85;
  border-left: 2px solid var(--iron);
  z-index: 2;
}

/* ================= VOLUME ================= */
#volume-controls {
  position: absolute;
  top: 170px;
  right: 240px;
  background: rgba(20,10,40,0.7);
  padding: 6px;
  border-radius: 6px;
  z-index: 6;
}
</style>
</head>

<body>

<!-- Curtains -->
<div id="curtains">
  <div class="curtain" id="curtain-left"></div>
  <div class="curtain" id="curtain-right"></div>
</div>

<!-- Balcony -->
<div id="balcony">
  <div id="hans-avatar"></div>
  <div id="hans-dialogue">‚Ä¶</div>
</div>

<div id="divider"></div>

<!-- Library -->
<div id="library">

  <div class="shelf-column">
    <div class="shelf">
      <div class="shelf-title">Shakespeare ‚Äî Tragedies</div>
      <div class="book-slot"></div>
      <div class="book-slot"></div>
      <div class="book-slot"></div>
    </div>
    <div class="shelf">
      <div class="shelf-title">Gothic Fiction</div>
      <div class="book-slot"></div>
      <div class="book-slot"></div>
    </div>
  </div>

  <div class="shelf-column">
    <div class="shelf">
      <div class="shelf-title">Poetry</div>
      <div class="book-slot"></div>
      <div class="book-slot"></div>
    </div>
  </div>

</div>

<!-- Carrier -->
<div id="carrier">üìö Book Carrier</div>

<!-- Hans Video -->
<video id="magnified-hans" autoplay loop muted playsinline>
  <source src="hans-pippet.mp4" type="video/mp4">
</video>

<div id="volume-controls">
  <button id="mute-btn">üîá</button>
  <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="0.6">
</div>

<script>
/* ================= CURTAINS ================= */
setTimeout(() => {
  document.getElementById("curtain-left").style.transform = "translateX(-100%)";
  document.getElementById("curtain-right").style.transform = "translateX(100%)";
}, 800);

/* ================= HANS MEMORY ================= */
const memory = JSON.parse(localStorage.getItem("hansMemory") || "{}");
memory.visits = (memory.visits || 0) + 1;
localStorage.setItem("hansMemory", JSON.stringify(memory));

const dialogue = document.getElementById("hans-dialogue");
dialogue.textContent = memory.visits === 1
  ? "Oh. A guest. Do wipe your feet ‚Äî these floors respect order."
  : "Back again. Progress is possible. Unlikely, but possible.";

/* ================= BOOK THROW ================= */
function throwBook(title) {
  const book = document.createElement("div");
  book.className = "book";
  book.dataset.title = title;
  book.style.left = Math.random() * 60 + "%";
  book.style.top = "-100px";
  document.body.appendChild(book);

  let y = -100;
  const fall = setInterval(() => {
    y += 8;
    book.style.top = y + "px";
    if (y > window.innerHeight - 140) clearInterval(fall);
  }, 30);
}

throwBook("Othello");

/* ================= AUDIO ================= */
const hansVideo = document.getElementById("magnified-hans");
const slider = document.getElementById("volume-slider");
const muteBtn = document.getElementById("mute-btn");

document.addEventListener("click", () => {
  hansVideo.muted = false;
  hansVideo.volume = slider.value;
}, { once: true });

slider.oninput = () => {
  hansVideo.volume = slider.value;
  hansVideo.muted = slider.value == 0;
  muteBtn.textContent = hansVideo.muted ? "üîá" : "üîä";
};

muteBtn.onclick = () => {
  hansVideo.muted = !hansVideo.muted;
  muteBtn.textContent = hansVideo.muted ? "üîá" : "üîä";
};
</script>

</body>
</html>
